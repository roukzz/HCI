!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("prop-types")):"function"==typeof define&&define.amd?define(["react","prop-types"],t):"object"==typeof exports?exports.AudioPlayer=t(require("react"),require("prop-types")):e.AudioPlayer=t(e.React,e.PropTypes)}(window,function(e,t){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist",i(i.s=4)}([function(t,i){t.exports=e},function(e,i){e.exports=t},function(e,t,i){var a;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var i={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var n=typeof a;if("string"===n||"number"===n)e.push(a);else if(Array.isArray(a)&&a.length){var s=r.apply(null,a);s&&e.push(s)}else if("object"===n)for(var o in a)i.call(a,o)&&a[o]&&e.push(o)}}return e.join(" ")}void 0!==e&&e.exports?(r.default=r,e.exports=r):void 0===(a=function(){return r}.apply(t,[]))||(e.exports=a)}()},function(e,t,i){"use strict";e.exports=function(e,t,i){if("function"==typeof Array.prototype.findIndex)return e.findIndex(t,i);if("function"!=typeof t)throw new TypeError("predicate must be a function");var a=Object(e),r=a.length;if(0===r)return-1;for(var n=0;n<r;n++)if(t.call(i,a[n],n,a))return n;return-1}},function(e,t,i){"use strict";i.r(t);var a=i(0),r=i.n(a),n=i(1),s=i.n(n),o=i(3),u=i.n(o),l=i(2),d=i.n(l),c=(i(5),function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}()),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e};function h(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}var f=[{name:"hideBackSkip",alternativeMessage:'Exclude "backskip" from `controls` to hide the back skip button.'},{name:"hideForwardSkip",alternativeMessage:'Exclude "forwardskip" from `controls` to hide the back skip button.'},{name:"disableSeek",alternativeMessage:'Pass "progressdisplay" to `controls` (instead of "progress") for a non-seekable progress bar.'},{name:"playlist[?].displayText",alternativeMessage:"Use `title` and `artist` to provide track information, and override  the `getDisplayText` function prop for custom display if needed."},{name:"style",alternativeMessage:"Apply styles to a container element or use CSS."}],y=console.log.bind(console),m=console.error?console.error.bind(console):y,v=console.warn?console.warn.bind(console):y;function k(e){return f.filter(function(t){return function e(t,i){if(0===t.length)return!0;var a=t[0],r=t.slice(1);return"?"===a?Object.keys(i).some(function(t){return e(r,i[t])}):a in i&&e(r,i[a])}(function(e){return e.split(/\.|\[|\]/).filter(function(e){return e})}(t.name),e)})}var g=[];function b(e){var t=!0,i=!1,a=void 0;try{for(var r,n=k(e)[Symbol.iterator]();!(t=(r=n.next()).done);t=!0){var s=r.value;-1===g.indexOf(s.name)&&(v("\n        The `"+s.name+"` prop is deprecated. It will be removed\n        in react-responsive-audio-player v2.0.0.\n        "+s.alternativeMessage),g.push(s.name))}}catch(e){i=!0,a=e}finally{try{!t&&n.return&&n.return()}finally{if(i)throw a}}}var T=0;function E(){return(T++).toString()}function S(e){if(m(e),"NotAllowedError"===e.name){var t="Audio playback failed at "+(new Date).toLocaleTimeString()+"! (Perhaps autoplay is disabled in this browser.)";v(t)}}function x(e){var t=Math.floor(e/60),i=(e%60).toFixed();return(t<10?"0":"")+t+":"+(i<10?"0":"")+i}var L=["previoustrack","nexttrack","seekbackward","seekforward"],w=function(e){var t=e.hidden,i=e.back,a=e.onClick;return r.a.createElement("div",{id:"skip_button",className:d()("skip_button audio_button",{hidden:t,back:i}),onClick:a},r.a.createElement("div",{className:"skip_button_inner"},r.a.createElement("div",{className:"right_facing_triangle"}),r.a.createElement("div",{className:"right_facing_triangle"})))},P=function(e){return r.a.createElement("div",{id:"audio_progress_container",className:"audio_progress_container",ref:e.onRef,onMouseDown:e.onMouseTouchStart,onTouchStart:e.onMouseTouchStart},r.a.createElement("div",{id:"audio_progress",className:"audio_progress",style:{width:e.progressBarWidth}}),r.a.createElement("div",{id:"audio_progress_overlay",className:"audio_progress_overlay"},r.a.createElement("div",{className:"audio_info_marquee"},r.a.createElement("div",{id:"audio_info",className:"audio_info noselect",draggable:"false"},e.displayText)),r.a.createElement("div",{id:"audio_time_progress",className:"audio_time_progress noselect",draggable:"false"},e.timeRatio)))},_={backskip:function(e){var t=e.audioPlayer;return r.a.createElement(w,{audioPlayer:t,hidden:t.props.hideBackSkip,back:!0,onClick:t.backSkip})},forwardskip:function(e){var t=e.audioPlayer;return r.a.createElement(w,{audioPlayer:t,hidden:t.props.hideForwardSkip,back:!1,onClick:t.skipToNextTrack})},playpause:function(e){var t=e.audioPlayer;return r.a.createElement("div",{id:"play_pause_button",className:d()("play_pause_button audio_button",{paused:t.state.paused}),onClick:t.togglePause},r.a.createElement("div",{className:"play_pause_inner"},r.a.createElement("div",{className:"left"}),r.a.createElement("div",{className:"right"}),r.a.createElement("div",{className:"triangle_1"}),r.a.createElement("div",{className:"triangle_2"})))},spacer:function(){return r.a.createElement("div",{className:"spacer"})},progressdisplay:P,progress:function(e){return r.a.createElement(P,p({},e,{onMouseTouchStart:e.audioPlayer.adjustDisplayedTime,onRef:function(t){return e.audioPlayer.audioProgressContainer=t}}))}},M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.seekInProgress=!1,i.currentTrackIndex=0,i.defaultState={activeTrackIndex:-1,paused:!0,displayedTime:0},i.state=i.defaultState,i.controlKeys=e.controls.map(E),i.audio=null,i.audioProgressContainer=null,i.setAudioElementRef=i.setAudioElementRef.bind(i),i.backSkip=i.backSkip.bind(i),i.skipToNextTrack=i.skipToNextTrack.bind(i),i.togglePause=i.togglePause.bind(i),i.adjustDisplayedTime=i.adjustDisplayedTime.bind(i),i.seekReleaseListener=function(e){return i.seek(e)},i.audioPlayListener=function(){i.setState({paused:!1}),i.stealMediaSession()},i.audioPauseListener=function(){return i.setState({paused:!0})},i.audioEndListener=function(){var e=i.props.gapLengthInSeconds||0;clearTimeout(i.gapLengthTimeout),i.gapLengthTimeout=setTimeout(function(){return i.skipToNextTrack()},1e3*e)},i.audioStallListener=function(){return i.togglePause(!0)},i.audioTimeUpdateListener=function(){return i.handleTimeUpdate()},i.audioMetadataLoadedListener=function(){return i.setState({activeTrackIndex:i.currentTrackIndex})},i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),c(t,[{key:"componentDidMount",value:function(){var e=this;b(this.props),window.addEventListener("mousemove",this.adjustDisplayedTime),document.addEventListener("touchmove",this.adjustDisplayedTime),window.addEventListener("mouseup",this.seekReleaseListener),document.addEventListener("touchend",this.seekReleaseListener);var t=this.audio;if(t.preload="metadata",t.crossOrigin=this.props.crossOrigin,t.addEventListener("play",this.audioPlayListener),t.addEventListener("pause",this.audioPauseListener),t.addEventListener("ended",this.audioEndListener),t.addEventListener("stalled",this.audioStallListener),t.addEventListener("timeupdate",this.audioTimeUpdateListener),t.addEventListener("loadedmetadata",this.audioMetadataLoadedListener),this.addMediaEventListeners(this.props.onMediaEvent),this.props.playlist&&this.props.playlist.length&&(this.updateSource(),this.props.autoplay)){var i=this.props.autoplayDelayInSeconds||0;clearTimeout(this.delayTimeout),this.delayTimeout=setTimeout(function(){return e.togglePause(!1)},1e3*i)}this.warnedAboutPlaylistMutation||(this.lastPlaylistCopy=this.props.playlist&&[].concat(h(this.props.playlist)))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.adjustDisplayedTime),document.removeEventListener("touchmove",this.adjustDisplayedTime),window.removeEventListener("mouseup",this.seekReleaseListener),document.removeEventListener("touchend",this.seekReleaseListener),this.audio.removeEventListener("play",this.audioPlayListener),this.audio.removeEventListener("pause",this.audioPauseListener),this.audio.removeEventListener("ended",this.audioEndListener),this.audio.removeEventListener("stalled",this.audioStallListener),this.audio.removeEventListener("timeupdate",this.audioTimeUpdateListener),this.audio.removeEventListener("loadedmetadata",this.audioMetadataLoadedListener),this.removeMediaEventListeners(this.props.onMediaEvent),clearTimeout(this.gapLengthTimeout),clearTimeout(this.delayTimeout),this.audio.pause(),document.body.classList.remove("noselect")}},{key:"componentWillReceiveProps",value:function(e){var t=this;b(e),this.removeMediaEventListeners(this.props.onMediaEvent),this.addMediaEventListeners(e.onMediaEvent);var i=[].concat(h(this.props.controls));this.controlKeys=e.controls.map(function(e){var a=i.indexOf(e);return-1!==a&&i[a]?(i[a]=null,t.controlKeys[a]):E()}),this.audio.crossOrigin=e.crossOrigin;var a=e.playlist;if(!a||!a.length)return this.audio&&(this.audio.src=""),this.currentTrackIndex=0,this.setState(this.defaultState);var r=((this.props.playlist||[])[this.currentTrackIndex]||{}).url;this.currentTrackIndex=u()(a,function(e){return e.url&&r===e.url}),-1!==this.currentTrackIndex&&this.setState({activeTrackIndex:this.currentTrackIndex})}},{key:"addMediaEventListeners",value:function(e){var t=this;e&&Object.keys(e).forEach(function(i){"function"==typeof e[i]&&t.audio.addEventListener(i,e[i])})}},{key:"removeMediaEventListeners",value:function(e){var t=this;e&&Object.keys(e).forEach(function(i){"function"==typeof e[i]&&t.audio.removeEventListener(i,e[i])})}},{key:"componentDidUpdate",value:function(e){var t=this;-1===this.currentTrackIndex&&this.skipToNextTrack(!1),e===this.props||this.audio.paused||this.stealMediaSession(),!this.warnedAboutPlaylistMutation&&this.props.playlist&&e.playlist&&e.playlist===this.props.playlist&&this.props.playlist.length&&(this.lastPlaylistCopy.length!==this.props.playlist.length||this.currentTrackIndex>-1&&this.lastPlaylistCopy[this.currentTrackIndex]!==this.props.playlist[this.currentTrackIndex]||this.props.playlist.some(function(e,i){return t.lastPlaylistCopy[i]!==e}))&&(v("\n        Making direct changes to the `playlist` prop is deprecated usage\n        which will stop working correctly in react-responsive-audio-player\n        v2.0.0. Instead you should make a new shallow copy of `playlist` and\n        pass that copy, modified, when you need to update playlist contents.\n        For more information, see:\n        https://github.com/benwiley4000/react-responsive-audio-player/blob/bcab159f365bd82ad25ee9e0288224e0d174b886/docs/playlist_in_progress.md"),this.warnedAboutPlaylistMutation=!0),this.warnedAboutPlaylistMutation||(this.lastPlaylistCopy=this.props.playlist&&[].concat(h(this.props.playlist)))}},{key:"setAudioElementRef",value:function(e){this.audio=e,"function"==typeof this.props.audioElementRef&&this.props.audioElementRef(this.audio)}},{key:"stealMediaSession",value:function(){var e=this;window.MediaSession&&navigator.mediaSession instanceof MediaSession&&(navigator.mediaSession.metadata=new MediaMetadata(this.props.playlist[this.currentTrackIndex]),L.map(function(t){if(-1===e.props.supportedMediaSessionActions.indexOf(t))return null;var i=e.props.mediaSessionSeekLengthInSeconds;switch(t){case"play":return e.togglePause.bind(e,!1);case"pause":return e.togglePause.bind(e,!0);case"previoustrack":return e.backSkip;case"nexttrack":return e.skipToNextTrack;case"seekbackward":return function(){return e.audio.currentTime-=i};case"seekforward":return function(){return e.audio.currentTime+=i};default:return}}).forEach(function(e,t){navigator.mediaSession.setActionHandler(L[t],e)}))}},{key:"togglePause",value:function(e){if(this.audio){if("boolean"==typeof e?e:!this.state.paused)return this.audio.pause();if(this.props.playlist&&this.props.playlist.length)try{var t=this.audio.play();t&&"function"==typeof t.catch&&t.catch(function(e){if("AbortError"!==e.name)return Promise.reject(e)}).catch(S)}catch(e){S(e)}}}},{key:"skipToNextTrack",value:function(e){var t=this;if(this.audio&&this.props.playlist&&this.props.playlist.length){var i=this.currentTrackIndex+1;i>=this.props.playlist.length&&(i=0),this.currentTrackIndex=i;var a=!this.props.cycle&&0===this.currentTrackIndex||"boolean"==typeof e&&!e;a&&this.togglePause(!0),this.setState({activeTrackIndex:-1,displayedTime:0},function(){setTimeout(function(){t.updateSource(),a||t.togglePause(!1)})})}}},{key:"backSkip",value:function(){if(this.props.playlist&&this.props.playlist.length){var e=this.audio,t=this.props.stayOnBackSkipThreshold;if(isNaN(t)&&(t=5),e.currentTime>=t)return e.currentTime=0;var i=this.currentTrackIndex-1;i<0&&(i=this.props.playlist.length-1),this.currentTrackIndex=i-1,this.skipToNextTrack()}}},{key:"updateSource",value:function(){this.audio.src=this.props.playlist[this.currentTrackIndex].url}},{key:"handleTimeUpdate",value:function(){!this.seekInProgress&&this.audio&&this.setState({displayedTime:this.audio.currentTime})}},{key:"adjustDisplayedTime",value:function(e){if(this.props.playlist&&this.props.playlist.length&&!this.props.disableSeek){if("mousedown"===e.type||"touchstart"===e.type)this.seekInProgress=!0,document.body.classList.add("noselect");else if(!this.seekInProgress)return;e.preventDefault();var t=this.audioProgressContainer.getBoundingClientRect(),i=("touch"===e.type.slice(0,5)?e.targetTouches.item(0).pageX:e.pageX)-t.left-document.body.scrollLeft,a=t.width,r=Math.max(0,Math.min(1,i/a));this.setState({displayedTime:r*this.audio.duration})}}},{key:"seek",value:function(e){if(document.body.classList.remove("noselect"),this.seekInProgress){e.preventDefault(),this.seekInProgress=!1;var t=this.state.displayedTime;isNaN(t)||(this.audio.currentTime=t)}}},{key:"render",value:function(){var e=this,t=this.state.activeTrackIndex,i=this.props.getDisplayText(this.props.playlist[t]),a=this.state.displayedTime,n=this.audio&&this.audio.duration||0,s=x(a)+" / "+x(n),o=a/n*100+"%";return r.a.createElement("div",{id:"audio_player",className:"audio_player",title:i,style:this.props.style},r.a.createElement("audio",{ref:this.setAudioElementRef}),this.props.controls.map(function(t,a){var n="progress"===t||"progressdisplay"===t?{displayText:i,timeRatio:s,progressBarWidth:o,audioPlayer:e}:{audioPlayer:e},u=_[t]||null;return r.a.createElement(u,p({},n,{key:e.controlKeys[a]}))}))}}]),t}();M.propTypes={playlist:s.a.array,controls:s.a.arrayOf(s.a.oneOf(["playpause","backskip","forwardskip","progress","progressdisplay","spacer"])),crossOrigin:s.a.oneOf(["anonymous","use-credentials"]),autoplay:s.a.bool,autoplayDelayInSeconds:s.a.number,gapLengthInSeconds:s.a.number,hideBackSkip:s.a.bool,hideForwardSkip:s.a.bool,cycle:s.a.bool,disableSeek:s.a.bool,stayOnBackSkipThreshold:s.a.number,supportedMediaSessionActions:s.a.arrayOf(s.a.oneOf(["play","pause","previoustrack","nexttrack","seekbackward","seekforward"]).isRequired).isRequired,mediaSessionSeekLengthInSeconds:s.a.number.isRequired,getDisplayText:s.a.func.isRequired,style:s.a.object,onMediaEvent:s.a.object,audioElementRef:s.a.func},M.defaultProps={cycle:!0,controls:["spacer","backskip","playpause","forwardskip","spacer","progress"],supportedMediaSessionActions:["play","pause","previoustrack","nexttrack"],mediaSessionSeekLengthInSeconds:10,getDisplayText:function(e){return e?e.displayText?e.displayText:e.title&&e.artist?e.artist+" - "+e.title:e.title||e.artist||e.album||"":""}},t.default=M},function(e,t,i){}]).default});
//# sourceMappingURL=audioplayer.min.js.map